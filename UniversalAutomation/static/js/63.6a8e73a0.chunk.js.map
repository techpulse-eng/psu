{"version":3,"sources":["components/settings/Log.tsx","components/settings/General.tsx","components/editor/themes/EditorThemes.tsx","components/ui/Editor/snippets.js","components/ui/Editor/Editor.tsx"],"names":["Log","content","title","bordered","readonly","value","language","options","readOnly","SettingsPage","Form","useForm","form","useAppStore","licensed","userData","useQuery","settings","data","isLoading","environments","variables","useMutation","onSuccess","queryClient","invalidateQueries","update","mutate","isUpdateLoading","React","useState","log","setLog","isLicensed","Feature","Automation","useEffect","connection","HubConnectionBuilder","withUrl","toRelativeUrl","withAutomaticReconnect","configureLogging","LogLevel","Debug","build","on","message","prev","Date","now","start","then","send","catch","err","console","stop","onFinish","values","key","action","name","labelCol","span","wrapperCol","labelAlign","initialValues","repositoryPath","databasePath","apiEnvironment","defaultEnvironment","securityEnvironment","subTitle","extra","Item","requiredRoles","allowedWithOneWayGitSync","loading","type","htmlType","Content","style","padding","size","direction","width","tabPosition","TabPane","tab","label","tooltip","defaultValue","defaultPage","Option","disabled","roles","includes","defaultChecked","hideApi","checkedChildren","unCheckedChildren","hideAutomation","hideDashboard","hideHomePage","hideRunAs","notificationLevel","concurrentJobLimit","min","max","color","jobHandshakeTimeout","logLevel","microsoftLogLevel","href","icon","FileZipOutlined","HistoryOutlined","map","env","disableAutoReload","disableUpdateCheck","proxyUri","filter","m","fallbackLanguageId","splatting","psuDark","base","inherit","rules","token","foreground","colors","psuLight","snippets","range","kind","documentation","insertText","loader","config","paths","vs","init","monaco","languages","registerCompletionItemProvider","provideCompletionItems","model","a","incomplete","suggestions","registerDocumentFormattingEditProvider","displayName","provideDocumentFormattingEdits","axios","post","getValue","headers","text","startColumn","startLineNumber","endLineNumber","getLineCount","endColumn","getLineMaxColumn","triggerChars","getKind","CompletionItemKind","Text","Method","Folder","File","Property","triggerCharacters","position","context","findIndex","x","triggerCharacter","cursorPosition","getOffsetAt","help","EditorContext","createContext","CodeEditor","children","refetch","isReadOnly","setIsReadOnly","isSaving","setIsSaving","mutateAsync","currentTheme","useThemeSwitcher","useMonaco","copy","useClipboard","success","editorRef","useRef","onSave","useCallback","resource","current","resourceInfo","self","startsWith","schemaName","preserveBOM","lineEnding","onError","error","refetchQueries","handleEditorDidMount","editor","register","id","setMonarchTokensProvider","tokenizer","root","getModel","onDidChangeContent","versionId","getVersionId","callback","delay","timer","args","clearTimeout","setTimeout","debounce","newVersionId","markerData","startLine","endLine","severity","MarkerSeverity","Error","setModelMarkers","addCommand","KeyMod","CtrlCmd","KeyCode","KEY_S","parent","addAction","keybindings","F5","precondition","keybindingContext","contextMenuGroupId","contextMenuOrder","run","ed","F8","trigger","defineTheme","setTheme","onCopy","zoomIn","zoomOut","useMemo","Provider","SaveButton","child","requiredAccessControls","AccessControlTypes","Edit","accessControls","cloneElement","props","SaveFilled","onClick","callAll","BaseEditor","useContext","theme","tip","height","onMount","FullEditor","showSave","actions","hideToolbar","usePageContext","bodyStyle","ZoomInOutlined","ZoomOutOutlined","LoadingOutlined","CopyFilled","scriptBlock","wordWrap","wrappingIndent","minimap","enabled","lineHeight","lineNumbersMinChars","scrollBeyondLastLine","hideCursorInOverviewRuler","overviewRulerLanes","overviewRulerBorder"],"mappings":"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","file":"static/js/63.6a8e73a0.chunk.js","sourcesContent":["import React from \"react\";\r\nimport { BaseEditor, CodeEditor } from \"components/ui/Editor/Editor\";\r\nimport { Card } from \"antd\";\r\n\r\nexport default function Log({ content }: { content: string }) {\r\n    return <Card title=\"Log\" bordered={false} >\r\n        <CodeEditor readonly={true}>\r\n            <BaseEditor value={content} language=\"psulog\" options={{ readOnly: true }} />\r\n        </CodeEditor>\r\n    </Card>\r\n}\r\n","import React from \"react\";\r\nimport {\r\n  Card,\r\n  Input,\r\n  InputNumber,\r\n  Tooltip,\r\n  Select,\r\n  Switch,\r\n  Form,\r\n  Layout,\r\n  Space,\r\n  Button,\r\n  PageHeader,\r\n  Tabs,\r\n} from \"antd\";\r\nimport { Environment, Feature, Settings, Variable } from \"../../types\";\r\nimport ThemeToggle from \"../ui/theme/themeToggle\";\r\nimport { useQuery } from \"react-query3\";\r\nimport queryClient, { useMutation } from \"components/utils/queryClient\";\r\nimport useAppStore from \"components/context/app/Hooks\";\r\nimport { FileZipOutlined, HistoryOutlined } from \"@ant-design/icons\";\r\nimport { HubConnectionBuilder, LogLevel } from \"@microsoft/signalr\";\r\nimport Log from \"./Log\";\r\nimport { toRelativeUrl } from \"components/utils/utils\";\r\nimport RoleGuard from \"components/standalone/role-guard\";\r\n\r\nexport default function SettingsPage() {\r\n  const [form] = Form.useForm();\r\n  const { licensed, userData } = useAppStore();\r\n  const { data: settings, isLoading } = useQuery<Settings>(\"/settings\");\r\n  const { data: environments } = useQuery<Environment[]>(\"/environment\");\r\n  const { data: variables } = useQuery<Variable[]>(\"/variable\");\r\n  const { mutate: update, isLoading: isUpdateLoading } = useMutation({\r\n    onSuccess: () => queryClient.invalidateQueries(\"/settings\"),\r\n  });\r\n  const [log, setLog] = React.useState(\"\");\r\n\r\n  const isLicensed = licensed(Feature.Automation);\r\n\r\n  React.useEffect(() => {\r\n    const connection = new HubConnectionBuilder()\r\n      .withUrl(toRelativeUrl(`/systemloghub`))\r\n      .withAutomaticReconnect()\r\n      .configureLogging(LogLevel.Debug)\r\n      .build();\r\n\r\n    connection.on(\"PushEventLog\", (message) => {\r\n      setLog(prev => prev + `[${Date.now()}] - ${message}\\r\\n`);\r\n    });\r\n\r\n    connection\r\n      .start()\r\n      .then(() => connection.send(\"subscribe\", \"system\"))\r\n      .catch((err) => console.log(\"signalr error\", err));\r\n    return () => { connection.stop() };\r\n    // eslint-disable-next-line \r\n  }, [true])\r\n\r\n\r\n\r\n  function onFinish(values) {\r\n    update({\r\n      key: \"/settings\",\r\n      action: \"update\",\r\n      ...{\r\n        ...settings,\r\n        ...values,\r\n      },\r\n    });\r\n  }\r\n\r\n  return (\r\n    <Form\r\n      form={form}\r\n      onFinish={onFinish}\r\n      name=\"main_settings_form\"\r\n      labelCol={{ span: 8 }}\r\n      wrapperCol={{ span: 16 }}\r\n      labelAlign=\"left\"\r\n      initialValues={{\r\n        ...settings,\r\n        repositoryPath: settings?.repositoryPath,\r\n        databasePath: settings?.databasePath,\r\n        apiEnvironment: settings?.apiEnvironment || \"Integrated\",\r\n        defaultEnvironment: settings?.defaultEnvironment || \"Integrated\",\r\n        securityEnvironment: settings?.securityEnvironment || \"Integrated\",\r\n      }}\r\n    >\r\n      <PageHeader title=\"General\" subTitle=\"General configuration settings.\" extra={[\r\n        <Form.Item>\r\n          <RoleGuard requiredRoles={[\"Administrator\"]} allowedWithOneWayGitSync={false}>\r\n            <Button\r\n              loading={isUpdateLoading}\r\n              type=\"primary\"\r\n              htmlType=\"submit\"\r\n            >\r\n              Save Changes\r\n            </Button>\r\n          </RoleGuard>\r\n        </Form.Item>\r\n      ]}>\r\n        <Layout>\r\n          <Layout.Content style={{ padding: 24 }}>\r\n            <Space size=\"large\" direction=\"vertical\" style={{ width: \"100%\" }}>\r\n              <Card bordered={false} loading={isLoading}>\r\n\r\n                <Tabs tabPosition=\"left\">\r\n                  <Tabs.TabPane tab=\"Admin Console\" key=\"console\">\r\n                    <Form.Item name=\"adminConsoleTitle\" label=\"Admin Console Title\" tooltip=\"The title to display in the Admin Console title bar.\">\r\n                      <Input />\r\n                    </Form.Item>\r\n                    <Form.Item name=\"adminConsoleLogo\" label=\"Admin Console Logo\" tooltip=\"The logo to display in the Admin Console title bar.\">\r\n                      <Input />\r\n                    </Form.Item>\r\n                    <Form.Item\r\n                      name=\"defaultPage\"\r\n                      label=\"Default Page\"\r\n                      tooltip=\"The page to navigate after you login.\"\r\n                    >\r\n\r\n                      <Select defaultValue={settings?.defaultPage}>\r\n                        <Select.Option value=\"home\">\r\n                          Home\r\n                        </Select.Option>\r\n                        <Select.Option value=\"apis/endpoints\">\r\n                          Endpoints\r\n                        </Select.Option>\r\n                        <Select.Option value=\"apis/ratelimits\">\r\n                          Rate Limits\r\n                        </Select.Option>\r\n                        <Select.Option value=\"automation/scripts\">\r\n                          Scripts\r\n                        </Select.Option>\r\n                        <Select.Option value=\"automation/jobs\">Jobs</Select.Option>\r\n                        <Select.Option value=\"automation/schedules\">\r\n                          Schedules\r\n                        </Select.Option>\r\n                        <Select.Option value=\"automation/triggers\">\r\n                          Triggers\r\n                        </Select.Option>\r\n                        <Select.Option value=\"dashboards\">Dashboards</Select.Option>\r\n                        <Select.Option value=\"dashboards/frameworks\">\r\n                          Frameworks\r\n                        </Select.Option>\r\n                        <Select.Option value=\"dashboards/modules\">\r\n                          Components\r\n                        </Select.Option>\r\n                        <Select.Option value=\"dashboards/folders\">\r\n                          Published Folders\r\n                        </Select.Option>\r\n                        <Select.Option value=\"dashboards/marketplace\">\r\n                          Marketplace\r\n                        </Select.Option>\r\n                        <Select.Option value=\"platform/variables\">\r\n                          Variables\r\n                        </Select.Option>\r\n                        <Select.Option\r\n                          disabled={!userData?.roles.includes(\"Administrator\")}\r\n                          value=\"settings\"\r\n                        >\r\n                          Settings\r\n                        </Select.Option>\r\n                        <Select.Option\r\n                          disabled={!userData?.roles.includes(\"Administrator\")}\r\n                          value=\"settings/tags\"\r\n                        >\r\n                          Tags\r\n                        </Select.Option>\r\n                        <Select.Option\r\n                          disabled={!userData?.roles.includes(\"Administrator\")}\r\n                          value=\"settings/environments\"\r\n                        >\r\n                          Environments\r\n                        </Select.Option>\r\n                        <Select.Option\r\n                          disabled={!userData?.roles.includes(\"Administrator\")}\r\n                          value=\"settings/configurations\"\r\n                        >\r\n                          Configurations\r\n                        </Select.Option>\r\n                        <Select.Option\r\n                          disabled={!userData?.roles.includes(\"Administrator\")}\r\n                          value=\"settings/license\"\r\n                        >\r\n                          License\r\n                        </Select.Option>\r\n                        <Select.Option\r\n                          disabled={!userData?.roles.includes(\"Administrator\")}\r\n                          value=\"security/roles\"\r\n                        >\r\n                          Roles\r\n                        </Select.Option>\r\n                        <Select.Option\r\n                          disabled={!userData?.roles.includes(\"Administrator\")}\r\n                          value=\"security/identities\"\r\n                        >\r\n                          Identities\r\n                        </Select.Option>\r\n                        <Select.Option\r\n                          disabled={!userData?.roles.includes(\"Administrator\")}\r\n                          value=\"security/tokens\"\r\n                        >\r\n                          Tokens\r\n                        </Select.Option>\r\n                        <Select.Option\r\n                          disabled={!userData?.roles.includes(\"Administrator\")}\r\n                          value=\"security/authentications\"\r\n                        >\r\n                          Authentications\r\n                        </Select.Option>\r\n                      </Select>\r\n                    </Form.Item>\r\n\r\n                    {/* UI settings */}\r\n                    <Form.Item name=\"hideApi\" label=\"Hide API Features\">\r\n                      <Switch\r\n                        defaultChecked={settings?.hideApi}\r\n                        checkedChildren=\"Yes\"\r\n                        unCheckedChildren=\"No\"\r\n                      />\r\n                    </Form.Item>\r\n                    <Form.Item name=\"hideAutomation\" label=\"Hide Automation Features\">\r\n                      <Switch\r\n                        defaultChecked={settings?.hideAutomation}\r\n                        checkedChildren=\"Yes\"\r\n                        unCheckedChildren=\"No\"\r\n                      />\r\n                    </Form.Item>\r\n                    <Form.Item name=\"hideDashboard\" label=\"Hide User Interface Features\">\r\n                      <Switch\r\n                        defaultChecked={settings?.hideDashboard}\r\n                        checkedChildren=\"Yes\"\r\n                        unCheckedChildren=\"No\"\r\n                      />\r\n                    </Form.Item>\r\n                    <Form.Item name=\"hideHomePage\" label=\"Hide Home Page\">\r\n                      <Switch\r\n                        defaultChecked={settings?.hideHomePage}\r\n                        checkedChildren=\"Yes\"\r\n                        unCheckedChildren=\"No\"\r\n                      />\r\n                    </Form.Item>\r\n                    <Form.Item name=\"hideRunAs\" label=\"Hide Run As\" tooltip=\"Hides the Run As drop down for scripts, schedules and dashboards.\">\r\n                      <Switch\r\n                        defaultChecked={settings?.hideRunAs}\r\n                        checkedChildren=\"Yes\"\r\n                        unCheckedChildren=\"No\"\r\n                      />\r\n                    </Form.Item>\r\n                    <Form.Item label=\"Dark Theme\">\r\n                      <ThemeToggle />\r\n                    </Form.Item>\r\n                    <Form.Item\r\n                      name=\"notificationLevel\"\r\n                      label=\"Notification Level\"\r\n                      tooltip=\"The level of notifications to display. For example, selecting Warning will display Warnings and Errors but not Information.\"\r\n                    >\r\n                      <Select defaultValue={settings?.notificationLevel}>\r\n                        <Select.Option value={0}>\r\n                          Information\r\n                        </Select.Option>\r\n                        <Select.Option value={1}>\r\n                          Warning\r\n                        </Select.Option>\r\n                        <Select.Option value={2}>\r\n                          Error\r\n                        </Select.Option>\r\n                      </Select>\r\n                    </Form.Item>\r\n                  </Tabs.TabPane>\r\n                  <Tabs.TabPane tab=\"Automation\" key=\"automation\">\r\n                    <Form.Item name=\"concurrentJobLimit\" label=\"Concurrent Job Limit\" tooltip=\"The number of jobs that can run at once.\">\r\n                      {isLicensed ? (\r\n                        <InputNumber\r\n                          defaultValue={settings?.concurrentJobLimit}\r\n                          min={2}\r\n                          max={1000}\r\n                        />\r\n                      ) : (\r\n                        <Tooltip\r\n                          color=\"blue\"\r\n                          title=\"Concurrent Jobs can only be increased when licensed.\"\r\n                        >\r\n                          <InputNumber min={2} max={2} defaultValue={2} />\r\n                        </Tooltip>\r\n                      )}\r\n                    </Form.Item>\r\n                    <Form.Item name=\"jobHandshakeTimeout\" label=\"Job Handshake Timeout\" tooltip=\"The amount of time to wait for an external job process to communicate back to the server\">\r\n                      <InputNumber defaultValue={settings?.jobHandshakeTimeout} />\r\n                    </Form.Item>\r\n                  </Tabs.TabPane>\r\n                  <Tabs.TabPane tab=\"Data\" key=\"data\">\r\n                    <Form.Item name=\"repositoryPath\" label=\"Repository Path\">\r\n                      <Input disabled />\r\n                    </Form.Item>\r\n                    <Form.Item name=\"databasePath\" label=\"Database Path\">\r\n                      <Input disabled />\r\n                    </Form.Item>\r\n                    <Form.Item name=\"scriptBaseFolder\" label=\"Script Base Folder\" tooltip=\"The base path to store scripts within the repository.\">\r\n                      <Input />\r\n                    </Form.Item>\r\n                    <Form.Item name=\"groomDays\" label=\"Data retention\" tooltip=\"The number of days to retain data from jobs. The default is 30 days.\">\r\n                      <InputNumber min={0} max={60} />\r\n                    </Form.Item>\r\n                    <Form.Item name=\"groomInterval\" label=\"Data groom interval\" tooltip=\"How frequently, in minutes, the data groom job is run.\">\r\n                      <InputNumber min={1} max={59} />\r\n                    </Form.Item>\r\n                  </Tabs.TabPane>\r\n                  <Tabs.TabPane tab=\"Diagnostics\" key=\"diagnostics\">\r\n                    <Form.Item name=\"logLevel\" label=\"Log Level\" tooltip=\"Logging level for PowerShell Universal\">\r\n                      <Select defaultValue={settings?.logLevel}>\r\n                        <Select.Option value=\"Debug\">Debug</Select.Option>\r\n                        <Select.Option value=\"Information\">\r\n                          Information\r\n                        </Select.Option>\r\n                        <Select.Option value=\"Warning\">Warning</Select.Option>\r\n                        <Select.Option value=\"Error\">Error</Select.Option>\r\n                      </Select>\r\n                    </Form.Item>\r\n                    <Form.Item name=\"microsoftLogLevel\" label=\"Microsoft Log Level\" tooltip=\"Logging level for the Microsoft components, like the webserver, of PowerShell Universal.\">\r\n                      <Select defaultValue={settings?.microsoftLogLevel}>\r\n                        <Select.Option value=\"Debug\">Debug</Select.Option>\r\n                        <Select.Option value=\"Information\">\r\n                          Information\r\n                        </Select.Option>\r\n                        <Select.Option value=\"Warning\">Warning</Select.Option>\r\n                        <Select.Option value=\"Error\">Error</Select.Option>\r\n                      </Select>\r\n                    </Form.Item>\r\n                    <Space>\r\n                      <Button href=\"/api/v1/log\" icon={<FileZipOutlined />}>Download Logs</Button>\r\n                      <Button href=\"/hangfire\" icon={<HistoryOutlined />}>Job Details</Button>\r\n                    </Space>\r\n                    <Log content={log} />\r\n                  </Tabs.TabPane>\r\n                  <Tabs.TabPane tab=\"Environments\" key=\"environments\">\r\n                    <Form.Item\r\n                      name=\"apiEnvironment\"\r\n                      label=\"API Environment\"\r\n                      tooltip=\"The default environment to use when invoking API endpoints. This overrides the Default Environment.\"\r\n                    >\r\n                      <Select>\r\n                        {environments?.map((env) => (\r\n                          <Select.Option key={env.name} value={env.name}>\r\n                            {env.name}\r\n                          </Select.Option>\r\n                        ))}\r\n                      </Select>\r\n                    </Form.Item>\r\n                    <Form.Item name=\"defaultEnvironment\" label=\"Default Environment\" tooltip=\"The default environment to use for all features.\">\r\n                      <Select>\r\n                        {environments?.map((env) => (\r\n                          <Select.Option key={env.name} value={env.name}>\r\n                            {env.name}\r\n                          </Select.Option>\r\n                        ))}\r\n                      </Select>\r\n                    </Form.Item>\r\n                    <Form.Item\r\n                      name=\"securityEnvironment\"\r\n                      label=\"Security Environment\"\r\n                      tooltip=\"By default, authentication and authorization happen within the Universal.Server.exe process. To run these out of process, select an environment to run on\"\r\n                    >\r\n                      <Select>\r\n                        {environments?.map((env) => (\r\n                          <Select.Option key={env.name} value={env.name}>\r\n                            {env.name}\r\n                          </Select.Option>\r\n                        ))}\r\n                      </Select>\r\n                    </Form.Item>\r\n                  </Tabs.TabPane>\r\n                  <Tabs.TabPane tab=\"Platform\" key=\"platform\">\r\n                    <Form.Item\r\n                      name=\"disableAutoReload\"\r\n                      label=\"Disable Auto Reload\"\r\n                      tooltip=\"Server-wide setting that will disable the auto reload configuration files if they change on disk\"\r\n                    >\r\n                      <Switch\r\n                        defaultChecked={settings?.disableAutoReload}\r\n                        checkedChildren=\"Yes\"\r\n                        unCheckedChildren=\"No\"\r\n                      />\r\n                    </Form.Item>\r\n                    <Form.Item name=\"disableUpdateCheck\" label=\"Disable Update Check\" tooltip=\"Prevents PowerShell Universal from checking for updates.\">\r\n                      <Switch\r\n                        defaultChecked={settings?.disableUpdateCheck}\r\n                        checkedChildren=\"Yes\"\r\n                        unCheckedChildren=\"No\"\r\n                      />\r\n                    </Form.Item>\r\n                    <Form.Item name=\"proxyUri\" label=\"Proxy URL\" tooltip=\"The address of the proxy server to use when communicating to external addresses for licensing and the marketplace.\">\r\n                      <Input defaultValue={settings?.proxyUri} />\r\n                    </Form.Item>\r\n                    <Form.Item name=\"proxyCredential\" label=\"Proxy Credential\" tooltip=\"The credential to use when communicating with the proxy server.\">\r\n                      <Select>\r\n                        {variables?.filter(m => m.type === \"PSCredential\").map((env) => (\r\n                          <Select.Option key={env.name} value={env.name}>\r\n                            {env.name}\r\n                          </Select.Option>\r\n                        ))}\r\n                      </Select>\r\n                    </Form.Item>\r\n                    <Form.Item name=\"fallbackLanguageId\" label=\"Fallback Language ID\" tooltip=\"The language ID to use when a resource can't be found for the user's language.\">\r\n                      <Input defaultValue={settings?.fallbackLanguageId} />\r\n                    </Form.Item>\r\n                    <Form.Item name=\"splatting\" label=\"Configuration File Splatting\" tooltip=\"When enabled, all configure files will be generated using splatting.\">\r\n                      <Switch\r\n                        defaultChecked={settings?.splatting}\r\n                        checkedChildren=\"Yes\"\r\n                        unCheckedChildren=\"No\"\r\n                      />\r\n                    </Form.Item>\r\n                  </Tabs.TabPane>\r\n                </Tabs>\r\n\r\n\r\n\r\n\r\n\r\n\r\n              </Card>\r\n            </Space>\r\n          </Layout.Content>\r\n        </Layout>\r\n      </PageHeader>\r\n    </Form>\r\n  );\r\n}\r\n","import { editor } from \"monaco-editor\";\r\n\r\nconst psuDark: editor.IStandaloneThemeData = {\r\n  base: \"vs-dark\" as editor.BuiltinTheme,\r\n  inherit: true,\r\n  rules: [\r\n    { token: \"custom-error\", foreground: \"d32029\"},\r\n    { token: \"custom-verbose\", foreground: \"177ddc\" },\r\n    { token: \"custom-warning\", foreground: \"d89614\" },\r\n    { token: \"custom-debug\", foreground: \"13a8a8\" },\r\n    \r\n  ],\r\n  colors: {\r\n    \"activityBar.background\": \"#060606\",\r\n    \"activityBar.foreground\": \"#A9A9A9\",\r\n    \"editor.background\": \"#060606\",\r\n    \"editor.foreground\": \"#ffffff4d\",\r\n    \"activityBarBadge.background\": \"#A9A9A9\",\r\n    \"editor.lineHighlightBackground\": \"#141414\",\r\n    \"editor.selectionBackground\": \"#141414\",\r\n  },\r\n};\r\n\r\nconst psuLight: editor.IStandaloneThemeData = {\r\n  base: \"vs\" as editor.BuiltinTheme,\r\n  inherit: true,\r\n  rules: [\r\n    { token: \"custom-error\", foreground: \"d32029\"},\r\n    { token: \"custom-verbose\", foreground: \"177ddc\" },\r\n    { token: \"custom-warning\", foreground: \"d89614\" },\r\n    { token: \"custom-debug\", foreground: \"13a8a8\" },\r\n    \r\n  ],\r\n  colors: {\r\n    \"activityBar.background\": \"#E1ECF9\",\r\n    \"activityBar.foreground\": \"#A9A9A9\",\r\n    \"editor.background\": \"#ffffff\",\r\n    \"editor.foreground\": \"#000000\",\r\n    \"activityBarBadge.background\": \"#A9A9A9\",\r\n    \"editor.lineHighlightBackground\": \"#c2c2c2\",\r\n    \"editor.selectionBackground\": \"#e1ecf8\",\r\n  },\r\n};\r\n\r\nexport { psuDark, psuLight };\r\n","const snippets = [\r\n    {\r\n        range: null,\r\n        label: 'Dashboard: Modal',\r\n        kind: 27,\r\n        documentation: 'Creates a new modal.',\r\n        insertText: 'Show-UDModal -Content {\\n\\tNew-UDTypography \"Hello, World\"\\n}'\r\n    },\r\n    {\r\n        range: null,\r\n        label: 'Dashboard: Chart with Colors',\r\n        kind: 27,\r\n        documentation: 'Creates a chart with colors',\r\n        insertText: `$Data = Get-Process | Sort-Object -Property CPU -Descending | Select-Object -First 10 \r\n$Options = @{\r\n    Type = 'bar'\r\n    Data = $Data\r\n    BackgroundColor = 'Red'\r\n    BorderColor = '#c61d4a'\r\n    HoverBackgroundColor = 'Blue'\r\n    HoverBorderColor = '#451dc6'\r\n    DataProperty = 'CPU'\r\n    LabelProperty = 'ProcessName'\r\n}\r\n\r\nNew-UDChartJS @Options`\r\n    },\r\n    {\r\n        range: null,\r\n        label: 'Dashboard: Form with validation',\r\n        kind: 27,\r\n        documentation: 'Creates a form with validation',\r\n        insertText: `New-UDForm -Content {\r\nNew-UDTextbox -Id 'txtValidateForm'\r\n} -OnValidate {\r\n    $FormContent = $EventData\r\n\r\n    if ($FormContent.txtValidateForm -eq $null -or $FormContent.txtValidateForm -eq '') {\r\n        New-UDFormValidationResult -ValidationError \"txtValidateForm is required\"\r\n    } else {\r\n        New-UDFormValidationResult -Valid\r\n    }\r\n} -OnSubmit {\r\n    Show-UDToast -Message $Body\r\n}`\r\n    },\r\n];\r\n\r\nexport default snippets;\r\n","import React, { Fragment } from \"react\";\r\nimport { Button, Card, message, Spin, Tooltip } from \"antd\";\r\nimport { callAll, toRelativeUrl } from \"components/utils/utils\";\r\nimport queryClient, { useMutation } from \"components/utils/queryClient\";\r\nimport {\r\n  CopyFilled,\r\n  SaveFilled,\r\n  ZoomInOutlined,\r\n  ZoomOutOutlined,\r\n  LoadingOutlined,\r\n} from \"@ant-design/icons\";\r\nimport RoleGuard from \"components/standalone/role-guard\";\r\nimport Editor, {\r\n  useMonaco,\r\n  EditorProps,\r\n  loader,\r\n  Monaco,\r\n} from \"@monaco-editor/react\";\r\nimport { useThemeSwitcher } from \"react-css-theme-switcher\";\r\nimport { psuDark, psuLight } from \"../../editor/themes/EditorThemes\";\r\nimport useAppStore from \"components/context/app/Hooks\";\r\nimport { AccessControlTypes, Accessible } from \"types\";\r\nimport { editor, MarkerSeverity } from \"monaco-editor\";\r\nimport { LeftPanelSizeButton, usePageContext } from \"components/pages/Page\";\r\nimport useClipboard from \"use-clipboard-hook\";\r\nimport { CardProps } from \"antd/es\";\r\nimport axios from \"axios\";\r\nimport snippets from './snippets';\r\n\r\nloader.config({ paths: { vs: toRelativeUrl(\"/admin/vs\") } });\r\nloader.init().then(monaco => {\r\n  monaco.languages.registerCompletionItemProvider(\"powershell\", {\r\n    provideCompletionItems: async (model, options, token) => {\r\n\r\n      return {\r\n        incomplete: false,\r\n        suggestions: snippets\r\n      }\r\n    }\r\n  });\r\n\r\n  monaco.languages.registerDocumentFormattingEditProvider(\"powershell\", {\r\n    displayName: \"PowerShell\",\r\n    provideDocumentFormattingEdits: async (model, options, token) => {\r\n      let { data } = await axios.post(toRelativeUrl(`/api/v1/editor/format`), model.getValue(), {\r\n        headers: {\r\n          'content-type': 'text/plain'\r\n        }\r\n      });\r\n\r\n      return [{\r\n        text: data,\r\n        range: {\r\n          startColumn: 1,\r\n          startLineNumber: 1,\r\n          endLineNumber: model.getLineCount(),\r\n          endColumn: model.getLineMaxColumn(model.getLineCount())\r\n        }\r\n      }];\r\n    }\r\n  })\r\n\r\n  const triggerChars = [\"$\", \"-\", \"\\\\\", \"/\", \":\", \".\"]\r\n\r\n  const getKind = (type: number) => {\r\n    switch (type) {\r\n      case 0: return monaco.languages.CompletionItemKind.Text;\r\n      case 2: return monaco.languages.CompletionItemKind.Method;\r\n      case 3: return monaco.languages.CompletionItemKind.Folder;\r\n      case 4: return monaco.languages.CompletionItemKind.File;\r\n      case 5: return monaco.languages.CompletionItemKind.Property;\r\n      case 6: return monaco.languages.CompletionItemKind.Method;\r\n      case 7: return monaco.languages.CompletionItemKind.Property;\r\n      case 9: return monaco.languages.CompletionItemKind.Property;\r\n      default: return monaco.languages.CompletionItemKind.Text;\r\n    }\r\n  }\r\n\r\n  monaco.languages.registerCompletionItemProvider(\"powershell\", {\r\n    triggerCharacters: triggerChars,\r\n    provideCompletionItems: async (model, position, context) => {\r\n      if (triggerChars.findIndex(x => x === context.triggerCharacter) !== -1) {\r\n        let { data } = await axios.post(toRelativeUrl(`/api/v1/editor/complete`), {\r\n          content: model.getValue(),\r\n          cursorPosition: model.getOffsetAt(position)\r\n        });\r\n\r\n        const suggestions = data?.map(x => {\r\n          if (x.type === 3 || x.type === 4) {\r\n\r\n            return {\r\n              insertText: x.label,\r\n              label: x.label,\r\n              documentation: x.help,\r\n              kind: getKind(x.type),\r\n            }\r\n          }\r\n\r\n          return {\r\n            insertText: x.text,\r\n            label: x.text,\r\n            documentation: x.help,\r\n            kind: getKind(x.type),\r\n          }\r\n        });\r\n\r\n        return {\r\n          incomplete: false,\r\n          suggestions\r\n        }\r\n      }\r\n\r\n      return null;\r\n    }\r\n  });\r\n})\r\n\r\ninterface EditorContextProps {\r\n  isReadOnly: boolean;\r\n  setIsReadOnly: React.Dispatch<React.SetStateAction<boolean>>;\r\n  onSave: (key: any, action: any, resource: any) => Promise<void>;\r\n  monaco: Monaco;\r\n  editor: editor.IStandaloneCodeEditor;\r\n  userData: Accessible;\r\n  handleEditorDidMount: (editor: any, monaco: any, resource: any) => void;\r\n  currentTheme: string;\r\n  onCopy: () => void;\r\n  zoomIn: () => void;\r\n  zoomOut: () => void;\r\n  isSaving: boolean;\r\n}\r\n\r\nconst EditorContext = React.createContext<EditorContextProps>(null);\r\n\r\nfunction CodeEditor({ children, refetch = () => { }, readonly = false }) {\r\n  const [isReadOnly, setIsReadOnly] = React.useState(readonly);\r\n  const [isSaving, setIsSaving] = React.useState(false);\r\n  const { mutateAsync } = useMutation<any>();\r\n  const { currentTheme } = useThemeSwitcher();\r\n  const { userData } = useAppStore();\r\n  const monaco = useMonaco();\r\n\r\n  const { copy } = useClipboard({\r\n    onSuccess: (text) => message.success(`Copied.`),\r\n  });\r\n\r\n  const editorRef = React.useRef<editor.IStandaloneCodeEditor>(null);\r\n\r\n\r\n  const onSave = React.useCallback(\r\n    async (key: string, action: any, resource: any) => {\r\n\r\n      setIsSaving(true);\r\n      setIsReadOnly(true);\r\n\r\n      if (key === \"/script\") {\r\n        resource[\"content\"] = editorRef?.current?.getValue();\r\n      }\r\n\r\n      if (key === \"/endpoint\") {\r\n        key = resource?.resourceInfo?.self;\r\n        resource[\"scriptBlock\"] = editorRef?.current?.getValue();\r\n      }\r\n\r\n      if (key === \"/dashboard\") {\r\n        key = resource?.resourceInfo?.self;\r\n        resource[\"content\"] = editorRef?.current?.getValue();\r\n      }\r\n\r\n      if (key.startsWith(\"/role\")) {\r\n        key = resource?.resourceInfo?.self;\r\n        resource[\"policy\"] = editorRef?.current?.getValue();\r\n      }\r\n\r\n      if (key === \"/settings\") {\r\n        key = \"/settings/authentication/1\";\r\n        resource[\"settings\"] = editorRef?.current?.getValue();\r\n      }\r\n\r\n      if (key.startsWith('/module')) {\r\n        key = resource?.resourceInfo?.self;\r\n        resource[\"content\"] = editorRef?.current?.getValue();\r\n      }\r\n\r\n      if (resource?.resourceInfo?.schemaName === \"configuration\") {\r\n        resource[\"content\"] = editorRef?.current?.getValue({\r\n          preserveBOM: true,\r\n          lineEnding: \"\\r\\n\",\r\n        });\r\n      }\r\n\r\n      await mutateAsync(\r\n        { key, action, resource },\r\n        {\r\n          onError: (error) => {\r\n            setIsSaving(false);\r\n            setIsReadOnly(false);\r\n            message.error(error.message);\r\n          },\r\n          onSuccess: (data, variables) => {\r\n            setIsSaving(false);\r\n            setIsReadOnly(false);\r\n            message.success(\"Changes saved!\");\r\n            queryClient.refetchQueries(key);\r\n            refetch()\r\n          },\r\n        }\r\n      );\r\n    },\r\n    [mutateAsync, refetch]\r\n  );\r\n\r\n\r\n  const handleEditorDidMount = React.useCallback(\r\n    (editor, monaco, resource) => {\r\n      editorRef.current = editor;\r\n\r\n      monaco.languages.register({ id: \"psulog\" });\r\n      monaco.languages.setMonarchTokensProvider(\"psulog\", {\r\n        tokenizer: {\r\n          root: [\r\n            [/\\[error.*/, \"custom-error\"],\r\n            [/\\[verbose.*/, \"custom-verbose\"],\r\n            [/\\[warning.*/, \"custom-warning\"],\r\n            [/\\[debug.*/, \"custom-debug\"],\r\n            [/\\[information.*/, \"custom-info\"],\r\n          ],\r\n        },\r\n      });\r\n\r\n      const debounce = (callback, delay) => {\r\n        let timer;\r\n        return (...args) => {\r\n          clearTimeout(timer);\r\n          timer = setTimeout(() => callback(...args), delay);\r\n        }\r\n      }\r\n\r\n      const model = editor.getModel();\r\n      if (!readonly) {\r\n        model.onDidChangeContent(() => {\r\n          var versionId = model.getVersionId();\r\n          debounce(async () => {\r\n            var newVersionId = model.getVersionId();\r\n            if (versionId !== newVersionId) return;\r\n\r\n            let { data } = await axios.post(toRelativeUrl(`/api/v1/editor/parse`), model.getValue(), {\r\n              headers: {\r\n                'content-type': 'text/plain'\r\n              }\r\n            });\r\n\r\n            const markerData = data.map(x => {\r\n              return {\r\n                startColumn: x.token.startColumn,\r\n                endColumn: x.token.endColumn,\r\n                startLineNumber: x.token.startLine,\r\n                endLineNumber: x.token.endLine,\r\n                severity: MarkerSeverity.Error,\r\n                message: x.message\r\n              }\r\n            });\r\n\r\n            monaco.editor.setModelMarkers(model, 'powershell', markerData);\r\n          }, 300)();\r\n\r\n        });\r\n      }\r\n\r\n      if (resource) {\r\n        editor.addCommand(monaco.KeyMod.CtrlCmd | monaco.KeyCode.KEY_S, () => onSave(resource?.resourceInfo?.parent, \"update\", resource));\r\n      }\r\n\r\n      editor.addAction({\r\n        // An unique identifier of the contributed action.\r\n        id: \"refresh\",\r\n\r\n        // A label of the action that will be presented to the user.\r\n        label: \"Refresh\",\r\n\r\n        // An optional array of keybindings for the action.\r\n        keybindings: [monaco.KeyCode.F5],\r\n\r\n        // A precondition for this action.\r\n        precondition: null,\r\n\r\n        // A rule to evaluate on top of the precondition in order to dispatch the keybindings.\r\n        keybindingContext: null,\r\n\r\n        contextMenuGroupId: \"navigation\",\r\n\r\n        contextMenuOrder: 1.5,\r\n        run: function (ed) {\r\n          refetch();\r\n          return null;\r\n        },\r\n      });\r\n      editor.addAction({\r\n        // An unique identifier of the contributed action.\r\n        id: \"format\",\r\n\r\n        // A label of the action that will be presented to the user.\r\n        label: \"Format\",\r\n\r\n        // An optional array of keybindings for the action.\r\n        keybindings: [monaco.KeyCode.F8],\r\n\r\n        // A precondition for this action.\r\n        precondition: null,\r\n\r\n        // A rule to evaluate on top of the precondition in order to dispatch the keybindings.\r\n        keybindingContext: null,\r\n\r\n        contextMenuGroupId: \"navigation\",\r\n\r\n        contextMenuOrder: 1.5,\r\n\r\n        run: () => {\r\n          editor.trigger(\r\n            \"anyString\",\r\n            \"editor.action.formatDocument\",\r\n            null\r\n          );\r\n          // editorRef.current.getAction('editor.action.formatDocument').run();\r\n          return null;\r\n        },\r\n      });\r\n    },\r\n    [refetch, onSave, readonly]\r\n  );\r\n\r\n  React.useEffect(() => {\r\n    if (monaco) {\r\n      monaco.editor.defineTheme(\"psu-dark\", psuDark);\r\n      monaco.editor.defineTheme(\"psu-light\", psuLight);\r\n      monaco.editor.setTheme(\r\n        currentTheme === \"dark\" ? \"psu-dark\" : \"psu-light\"\r\n      );\r\n    }\r\n  }, [currentTheme, monaco]);\r\n\r\n  const onCopy = React.useCallback(() => copy(editorRef?.current?.getValue()), [\r\n    copy,\r\n  ]);\r\n  const zoomIn = () =>\r\n    editorRef?.current?.trigger(\"keyboard\", \"editor.action.fontZoomIn\", {});\r\n  const zoomOut = () =>\r\n    editorRef?.current?.trigger(\"keyboard\", \"editor.action.fontZoomOut\", {});\r\n\r\n  const value = React.useMemo(\r\n    () => ({\r\n      isReadOnly,\r\n      setIsReadOnly,\r\n      onSave,\r\n      monaco,\r\n      editor: editorRef?.current,\r\n      userData,\r\n      handleEditorDidMount,\r\n      currentTheme,\r\n      onCopy,\r\n      zoomIn,\r\n      zoomOut,\r\n      isSaving\r\n    }),\r\n    [\r\n      currentTheme,\r\n      handleEditorDidMount,\r\n      isReadOnly,\r\n      monaco,\r\n      onCopy,\r\n      onSave,\r\n      userData,\r\n      isSaving\r\n    ]\r\n  );\r\n\r\n  return (\r\n    <EditorContext.Provider value={value}>{children}</EditorContext.Provider>\r\n  );\r\n}\r\n\r\nfunction SaveButton({ children: child, resource }) {\r\n  return (\r\n    <RoleGuard requiredRoles={[\"Administrator\", \"Operator\"]} requiredAccessControls={AccessControlTypes.Edit} accessControls={resource?.accessControls} allowedWithOneWayGitSync={false}>\r\n      <Tooltip title=\"Save\">\r\n        {React.cloneElement(child, {\r\n          type: child?.props?.type || \"text\",\r\n          icon: child?.props?.icon || <SaveFilled />,\r\n          onClick: callAll(child?.props?.onClick),\r\n        })}\r\n      </Tooltip>\r\n    </RoleGuard>\r\n  );\r\n}\r\n\r\nfunction BaseEditor({ ...props }: EditorProps) {\r\n  const { currentTheme, handleEditorDidMount } = React.useContext(\r\n    EditorContext\r\n  );\r\n  return (\r\n    <Editor\r\n      theme={currentTheme === \"dark\" ? \"psu-dark\" : \"psu-light\"}\r\n      language=\"powershell\"\r\n      loading={<Spin tip=\"Loading content...\" />}\r\n      height=\"calc((100vh - 256px) - 48px)\"\r\n      onMount={(editor, monaco) => handleEditorDidMount(editor, monaco, null)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\ntype FullEditorProps = {\r\n  title?: string;\r\n  showSave?: boolean;\r\n  refetch?: () => void;\r\n  options?: EditorProps[\"options\"];\r\n  actions?: CardProps[\"extra\"]\r\n  hideToolbar?: boolean;\r\n} & EditorProps;\r\n\r\nfunction FullEditor({\r\n  title,\r\n  options,\r\n  showSave = true,\r\n  actions,\r\n  hideToolbar,\r\n  ...props\r\n}: FullEditorProps) {\r\n  const {\r\n    handleEditorDidMount,\r\n    currentTheme,\r\n    onSave,\r\n    onCopy,\r\n    zoomIn,\r\n    zoomOut,\r\n    isSaving\r\n  } = React.useContext(EditorContext);\r\n  const context = usePageContext();\r\n  const resource = context?.resource;\r\n\r\n\r\n  return (\r\n    <Card\r\n      bordered={false}\r\n      bodyStyle={{ padding: 0 }}\r\n      title={title}\r\n      extra={\r\n        !hideToolbar && <Fragment>\r\n          {actions}\r\n          <Tooltip title=\"Zoom in\">\r\n            <Button\r\n              type=\"text\"\r\n              icon={<ZoomInOutlined />}\r\n              onClick={() => zoomIn()}\r\n            />\r\n          </Tooltip>\r\n          <Tooltip title=\"Zoom out\">\r\n            <Button\r\n              type=\"text\"\r\n              icon={<ZoomOutOutlined />}\r\n              onClick={() => zoomOut()}\r\n            />\r\n          </Tooltip>\r\n          {showSave && (\r\n            <SaveButton resource={resource}>\r\n              <Button\r\n                icon={isSaving ? <LoadingOutlined /> : null}\r\n                onClick={callAll(() =>\r\n                  onSave(resource?.resourceInfo?.parent, \"update\", resource)\r\n                )}\r\n              />\r\n            </SaveButton>\r\n          )}\r\n          <Tooltip title=\"Copy\">\r\n            <Button\r\n              type=\"text\"\r\n              icon={<CopyFilled />}\r\n              onClick={() => onCopy()}\r\n            />\r\n          </Tooltip>\r\n          <LeftPanelSizeButton>\r\n            <Button />\r\n          </LeftPanelSizeButton>\r\n        </Fragment >\r\n      }\r\n    >\r\n      <BaseEditor\r\n        language=\"powershell\"\r\n        //@ts-ignore\r\n        height=\"calc((100vh - 256px) - 48px)\"\r\n        value={resource?.content || resource?.scriptBlock || resource?.settings || props?.value}\r\n        onMount={(editor, monaco) => handleEditorDidMount(editor, monaco, resource)}\r\n        theme={currentTheme === \"dark\" ? \"psu-dark\" : \"psu-light\"}\r\n        loading={props?.loading || <Spin tip=\"Loading content...\" />}\r\n        {...props}\r\n        options={{\r\n          wordWrap: \"on\",\r\n          wrappingIndent: \"same\",\r\n          minimap: {\r\n            enabled: false,\r\n          },\r\n          lineHeight: 20,\r\n          lineNumbersMinChars: 5,\r\n          scrollBeyondLastLine: false,\r\n          hideCursorInOverviewRuler: true,\r\n          overviewRulerLanes: 0,\r\n          overviewRulerBorder: false,\r\n          ...options,\r\n        }}\r\n      />\r\n    </Card >\r\n  );\r\n}\r\n\r\nconst useEditorContext = () => React.useContext(EditorContext);\r\n\r\nexport { CodeEditor, BaseEditor, FullEditor, SaveButton, useEditorContext };\r\n"],"sourceRoot":""}