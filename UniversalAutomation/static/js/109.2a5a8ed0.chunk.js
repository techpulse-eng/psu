(this["webpackJsonppowershelluniversal.adminconsole"]=this["webpackJsonppowershelluniversal.adminconsole"]||[]).push([[109],{1402:function(e,n,t){"use strict";t.r(n);var r=t(49),c=t.n(r),i=t(84),a=t(0),o=t.n(a),u=t(43),s=t(1164),l=t(1165),f=t(1166),d=t(1167),h=t(416),b=t(70),w=t(431),m=t(930),p=t(117),v=t.n(p),k=t(22),y=t(37),g=t(3),j=new l.FitAddon,O=new f.SearchAddon,x=new s.WebLinksAddon;n.default=function(){var e=Object(u.i)().id,n=o.a.useRef(null),t=o.a.useRef(""),r=Object(u.h)(),s=Object(m.a)((function(){return v.a.post(Object(y.s)("/api/v1/terminal/instance/".concat(e)))}),{onSuccess:function(e){k.a.refetchQueries("/terminal/instance",{stale:!0}),r(Object(y.s)("/admin/automation/terminals"))}}).mutateAsync,l=(new h.a).withUrl(Object(y.s)("/terminalhub")).withAutomaticReconnect().configureLogging(h.b.Debug).build(),f=o.a.useCallback(function(){var r=Object(i.a)(c.a.mark((function r(i){var a,o,u;return c.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,i.invoke("connect",Number.parseInt(e));case 2:a=r.sent,o=n.current.terminal,"success"!==a&&o.write("Failed to connect: "+a),u=function(){i.invoke("invoke","prompt").then((function(e){for(var n=e.trimEnd()+" ",t=0;t<n.length;t++)o.write("\b \b");o.write(n)}))},o.attachCustomKeyEventHandler((function(e){if("Home"===e.code&&"keydown"===e.type)return!1;if(e.ctrlKey&&"KeyC"===e.code&&"keydown"===e.type){var n=o.getSelection();if(n)return navigator.clipboard.writeText(n),!1}return e.ctrlKey&&"KeyV"===e.code&&"keydown"===e.type&&navigator.clipboard.readText().then((function(e){o.write(e)})),!0})),o.clear(),u(),n.current.terminal.onKey((function(e){if("\r"===e.key){if("cls"===t.current.toLocaleLowerCase()||"clear-host"===t.current.toLocaleLowerCase())return o.clear(),u(),void(t.current="");i.invoke("invoke",t.current).then((function(e){o.writeln(e),u(),t.current=""}))}if("\x1b"!==e.key)"\x7f"!==e.key?(n.current.terminal.write(e.key),t.current=t.current+e.key):t.current.length>0&&(t.current=t.current.substr(0,t.current.length-1),o.write("\b \b"));else if(t.current.length>0){for(var r=0;r<t.current.length;r++)o.write("\b \b");t.current=""}}));case 10:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),[n,e]);return Object(a.useEffect)((function(){var e=n.current;return j.fit(),l.start().then((function(){f(l)})).catch((function(e){n.current.terminal.write(e)})),n.current.terminal.writeln("Connecting..."),function(){return e.terminal.dispose()}}),[e,l,f]),Object(g.jsxs)("div",{className:"height100",children:[Object(g.jsx)(b.a,{icon:Object(g.jsx)(w.a,{}),danger:!0,onClick:function(){return s()},style:{float:"right"},children:"Exit"}),Object(g.jsx)(d.a,{ref:n,addons:[O,j,x],options:{cursorBlink:!0},className:"height100"})]})}}}]);
//# sourceMappingURL=109.2a5a8ed0.chunk.js.map