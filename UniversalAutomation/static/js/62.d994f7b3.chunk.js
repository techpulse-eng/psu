(this["webpackJsonppowershelluniversal.adminconsole"]=this["webpackJsonppowershelluniversal.adminconsole"]||[]).push([[62],{1463:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return E}));var r=n(12),o=n(49),a=n.n(o),i=n(84),c=n(27),l=n(0),u=n.n(l),s=n(692),d=n(925),v=n(926),f=n(693),p=n(165),b=n(70),m=n(954),g=n(387),j=n(924),h=n(928),x=n(117),O=n.n(x),k=n(996),y=n(454),C=n(415),w=n(3);function I(e){var t=e.fullName,n=Object(C.a)("/configuration/content/".concat(t)),r=n.data;return n.isLoading?Object(w.jsx)(w.Fragment,{}):Object(w.jsx)(y.c,{resource:{content:r.content,resourceInfo:{parent:"/configuration/content/".concat(t),self:"/configuration/content/".concat(t),schemaName:"configuration"}},children:Object(w.jsx)(k.b,{children:Object(w.jsx)(k.c,{title:null===r||void 0===r?void 0:r.name})})})}var L=n(450),D=n(600),F=n(605),S=n(632),T=n(431),V=n(348),B=n(1233),M=s.a.DirectoryTree,N=[{title:"Repository",key:"repo",isLeaf:!1,children:[]}],A=function(e){var t=e.visible,n=e.onCreate,r=e.onCancel,o=e.isLeaf,a=e.parent,i=d.a.useForm(),l=Object(c.a)(i,1)[0];return Object(w.jsx)(v.a,{visible:t,title:o?"Create File":"Create Folder",okText:"Create",cancelText:"Cancel",onCancel:r,onOk:function(){l.validateFields().then((function(e){l.resetFields(),n(e)})).catch((function(e){console.log("Validate Failed:",e)}))},children:Object(w.jsxs)(d.a,{form:l,layout:"vertical",name:"form_in_modal",initialValues:{parent:a,isLeaf:o},children:[Object(w.jsx)(d.a.Item,{hidden:!0,name:"parent",children:Object(w.jsx)(f.default,{})}),Object(w.jsx)(d.a.Item,{hidden:!0,name:"isLeaf",children:Object(w.jsx)(f.default,{})}),Object(w.jsx)(d.a.Item,{name:"name",label:"Name",rules:[{required:!0,message:"Please input the name!"}],children:Object(w.jsx)(f.default,{})})]})})};function E(){var e=u.a.useState(N),t=Object(c.a)(e,2),n=t[0],o=t[1],l=u.a.useState(null),s=Object(c.a)(l,2),d=s[0],v=s[1],f=u.a.useState(!0),x=Object(c.a)(f,2),k=x[0],y=x[1],E=u.a.useState(!1),P=Object(c.a)(E,2),K=P[0],R=P[1],U=Object(C.a)("/settings").data,$=function(){var e=Object(i.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post("/api/v1/vscode?insiders=".concat(t));case 2:n=e.sent.data,window.location.href=n;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=Object(i.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isLeaf){e.next=2;break}return e.abrupt("return");case 2:return n="repo"===t.key?"":t.key,e.next=5,O.a.get("/api/v1/configuration/list/".concat(n));case 5:r=e.sent,o((function(e){return W(e,t.key,r.data.map((function(e){return{title:e.name,key:e.fullName,isLeaf:e.isLeaf,children:[]}})))}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function q(e,t,n){return e.map((function(e){return e.key===t?(e.children.push(n),Object(r.a)({},e)):e.isLeaf?e:Object(r.a)(Object(r.a)({},e),{},{children:q(e.children,t,n)})}))}function H(e,t,n){return e.map((function(e){return e.key===t?(e.children=e.children.filter((function(e){return e.key!==n})),Object(r.a)({},e)):e.isLeaf?e:Object(r.a)(Object(r.a)({},e),{},{children:H(e.children,t,n)})}))}function W(e,t,n){return e.map((function(e){return e.key===t?Object(r.a)(Object(r.a)({},e),{},{children:n}):e.isLeaf?e:Object(r.a)(Object(r.a)({},e),{},{children:W(e.children,t,n)})}))}var G=Object(w.jsxs)(p.a,{children:[Object(w.jsx)(p.a.Item,{children:Object(w.jsx)(b.a,{icon:Object(w.jsx)(D.a,{}),onClick:function(){y(!0),R(!0)},type:"link",children:"File"})}),Object(w.jsx)(p.a.Item,{children:Object(w.jsx)(b.a,{icon:Object(w.jsx)(F.a,{}),onClick:function(){y(!1),R(!0)},type:"link",children:"Folder"})})]}),Z=function(){var e=Object(i.a)(a.a.mark((function e(){var t,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.delete("/api/v1/configuration/item/".concat(d.key));case 3:L.b.success("Deleted ".concat(d.key)),t=d.key.split(U.pathDivider),r=t.slice(0,t.length-1).join(U.pathDivider),1===t.length&&(r="repo"),H(n,r,d.key),v(null),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),L.b.error("Failed to delete item");case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),J=function(){var e=Object(i.a)(a.a.mark((function e(t){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="repo"===t.parent?"":t.parent+"/",e.prev=1,e.next=4,O.a.post("/api/v1/configuration/item/",{name:t.name,isLeaf:t.isLeaf,fullName:r+t.name});case 4:q(n,t.parent,{title:t.name,key:r+t.name,isLeaf:t.isLeaf,children:[]}),R(!1),L.b.success("Create Success"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),L.b.error("Failed to create item");case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsxs)(m.a,{title:"Configuration",subTitle:"Files used to configure PowerShell Universal.",extra:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(g.a,{overlay:G,placement:"bottomLeft",arrow:!0,disabled:null===d||void 0===d?void 0:d.isLeaf,children:Object(w.jsx)(b.a,{icon:Object(w.jsx)(S.a,{}),children:"New"})}),Object(w.jsx)(j.a,{title:"Are you sure you want to delete ".concat(null===d||void 0===d?void 0:d.key,"?"),onConfirm:Z,children:Object(w.jsx)(b.a,{icon:Object(w.jsx)(T.a,{}),disabled:null===d,children:"Delete"})}),Object(w.jsx)(b.a,{onClick:function(){return $(!1)},children:"Edit with VS Code"}),Object(w.jsx)(b.a,{onClick:function(){return $(!0)},children:"Edit with VS Code Insiders"})]}),children:[Object(w.jsxs)(B.a,{sizes:[25,75],direction:"horizontal",gutterAlign:"center",style:{display:"flex",flexDirection:"row"},children:[Object(w.jsx)("div",{children:Object(w.jsx)(M,{defaultExpandedKeys:["repo"],onSelect:function(e,t){v(null===t||void 0===t?void 0:t.selectedNodes[0])},treeData:n,loadData:z,style:{height:"100ch",overflow:"scroll"}})}),Object(w.jsxs)("div",{children:[(null===d||void 0===d?void 0:d.isLeaf)&&Object(w.jsx)(I,{fullName:null===d||void 0===d?void 0:d.key}),!(null===d||void 0===d?void 0:d.isLeaf)&&Object(w.jsx)(h.a,{icon:Object(w.jsx)(V.a,{}),title:"repo"===(null===d||void 0===d?void 0:d.key)?"Repository":null===d||void 0===d?void 0:d.key})]})]}),!(null===d||void 0===d?void 0:d.isLeaf)&&Object(w.jsx)(A,{parent:null===d||void 0===d?void 0:d.key,isLeaf:k,visible:K,onCreate:J,onCancel:function(){return R(!1)}})]})}},996:function(e,t,n){"use strict";n.d(t,"b",(function(){return P})),n.d(t,"a",(function(){return R})),n.d(t,"c",(function(){return U}));var r=n(74),o=n(12),a=n(27),i=n(49),c=n.n(i),l=n(84),u=n(0),s=n.n(u),d=n(450),v=n(92),f=n(280),p=n(961),b=n(70),m=n(37),g=n(22),j=n(443),h=n(360),x=n(361),O=n(106),k=n(437),y=n(99),C=n(1038),w=n(128),I={base:"vs-dark",inherit:!0,rules:[{token:"custom-error",foreground:"d32029"},{token:"custom-verbose",foreground:"177ddc"},{token:"custom-warning",foreground:"d89614"},{token:"custom-debug",foreground:"13a8a8"}],colors:{"activityBar.background":"#060606","activityBar.foreground":"#A9A9A9","editor.background":"#060606","editor.foreground":"#ffffff4d","activityBarBadge.background":"#A9A9A9","editor.lineHighlightBackground":"#141414","editor.selectionBackground":"#141414"}},L={base:"vs",inherit:!0,rules:[{token:"custom-error",foreground:"d32029"},{token:"custom-verbose",foreground:"177ddc"},{token:"custom-warning",foreground:"d89614"},{token:"custom-debug",foreground:"13a8a8"}],colors:{"activityBar.background":"#E1ECF9","activityBar.foreground":"#A9A9A9","editor.background":"#ffffff","editor.foreground":"#000000","activityBarBadge.background":"#A9A9A9","editor.lineHighlightBackground":"#c2c2c2","editor.selectionBackground":"#e1ecf8"}},D=n(111),F=n(48),S=n(1043),T=n(454),V=n(225),B=n(117),M=n.n(B),N=[{range:null,label:"Dashboard: Modal",kind:27,documentation:"Creates a new modal.",insertText:'Show-UDModal -Content {\n\tNew-UDTypography "Hello, World"\n}'},{range:null,label:"Dashboard: Chart with Colors",kind:27,documentation:"Creates a chart with colors",insertText:"$Data = Get-Process | Sort-Object -Property CPU -Descending | Select-Object -First 10 \n$Options = @{\n    Type = 'bar'\n    Data = $Data\n    BackgroundColor = 'Red'\n    BorderColor = '#c61d4a'\n    HoverBackgroundColor = 'Blue'\n    HoverBorderColor = '#451dc6'\n    DataProperty = 'CPU'\n    LabelProperty = 'ProcessName'\n}\n\nNew-UDChartJS @Options"},{range:null,label:"Dashboard: Form with validation",kind:27,documentation:"Creates a form with validation",insertText:"New-UDForm -Content {\nNew-UDTextbox -Id 'txtValidateForm'\n} -OnValidate {\n    $FormContent = $EventData\n\n    if ($FormContent.txtValidateForm -eq $null -or $FormContent.txtValidateForm -eq '') {\n        New-UDFormValidationResult -ValidationError \"txtValidateForm is required\"\n    } else {\n        New-UDFormValidationResult -Valid\n    }\n} -OnSubmit {\n    Show-UDToast -Message $Body\n}"}],A=n(3);C.c.config({paths:{vs:Object(m.s)("/admin/vs")}}),C.c.init().then((function(e){e.languages.registerCompletionItemProvider("powershell",{provideCompletionItems:function(){var e=Object(l.a)(c.a.mark((function e(t,n,r){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{incomplete:!1,suggestions:N});case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()}),e.languages.registerDocumentFormattingEditProvider("powershell",{displayName:"PowerShell",provideDocumentFormattingEdits:function(){var e=Object(l.a)(c.a.mark((function e(t,n,r){var o,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.a.post(Object(m.s)("/api/v1/editor/format"),t.getValue(),{headers:{"content-type":"text/plain"}});case 2:return o=e.sent,a=o.data,e.abrupt("return",[{text:a,range:{startColumn:1,startLineNumber:1,endLineNumber:t.getLineCount(),endColumn:t.getLineMaxColumn(t.getLineCount())}}]);case 5:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()});var t=["$","-","\\","/",":","."],n=function(t){switch(t){case 0:return e.languages.CompletionItemKind.Text;case 2:return e.languages.CompletionItemKind.Method;case 3:return e.languages.CompletionItemKind.Folder;case 4:return e.languages.CompletionItemKind.File;case 5:return e.languages.CompletionItemKind.Property;case 6:return e.languages.CompletionItemKind.Method;case 7:case 9:return e.languages.CompletionItemKind.Property;default:return e.languages.CompletionItemKind.Text}};e.languages.registerCompletionItemProvider("powershell",{triggerCharacters:t,provideCompletionItems:function(){var e=Object(l.a)(c.a.mark((function e(r,o,a){var i,l,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(-1===t.findIndex((function(e){return e===a.triggerCharacter}))){e.next=7;break}return e.next=3,M.a.post(Object(m.s)("/api/v1/editor/complete"),{content:r.getValue(),cursorPosition:r.getOffsetAt(o)});case 3:return i=e.sent,l=i.data,u=null===l||void 0===l?void 0:l.map((function(e){return 3===e.type||4===e.type?{insertText:e.label,label:e.label,documentation:e.help,kind:n(e.type)}:{insertText:e.text,label:e.text,documentation:e.help,kind:n(e.type)}})),e.abrupt("return",{incomplete:!1,suggestions:u});case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()})}));var E=s.a.createContext(null);function P(e){var t=e.children,n=e.refetch,r=void 0===n?function(){}:n,o=e.readonly,i=void 0!==o&&o,u=s.a.useState(i),v=Object(a.a)(u,2),f=v[0],p=v[1],b=s.a.useState(!1),j=Object(a.a)(b,2),h=j[0],x=j[1],O=Object(g.b)().mutateAsync,k=Object(w.b)().currentTheme,y=Object(D.a)().userData,F=Object(C.d)(),T=Object(V.a)({onSuccess:function(e){return d.b.success("Copied.")}}).copy,B=s.a.useRef(null),N=s.a.useCallback(function(){var e=Object(l.a)(c.a.mark((function e(t,n,o){var a,i,l,u,s,v,f,b,m,j,h,k;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),p(!0),"/script"===t&&(o.content=null===B||void 0===B||null===(i=B.current)||void 0===i?void 0:i.getValue()),"/endpoint"===t&&(t=null===o||void 0===o||null===(l=o.resourceInfo)||void 0===l?void 0:l.self,o.scriptBlock=null===B||void 0===B||null===(u=B.current)||void 0===u?void 0:u.getValue()),"/dashboard"===t&&(t=null===o||void 0===o||null===(s=o.resourceInfo)||void 0===s?void 0:s.self,o.content=null===B||void 0===B||null===(v=B.current)||void 0===v?void 0:v.getValue()),t.startsWith("/role")&&(t=null===o||void 0===o||null===(f=o.resourceInfo)||void 0===f?void 0:f.self,o.policy=null===B||void 0===B||null===(b=B.current)||void 0===b?void 0:b.getValue()),"/settings"===t&&(t="/settings/authentication/1",o.settings=null===B||void 0===B||null===(m=B.current)||void 0===m?void 0:m.getValue()),t.startsWith("/module")&&(t=null===o||void 0===o||null===(j=o.resourceInfo)||void 0===j?void 0:j.self,o.content=null===B||void 0===B||null===(h=B.current)||void 0===h?void 0:h.getValue()),"configuration"===(null===o||void 0===o||null===(a=o.resourceInfo)||void 0===a?void 0:a.schemaName)&&(o.content=null===B||void 0===B||null===(k=B.current)||void 0===k?void 0:k.getValue({preserveBOM:!0,lineEnding:"\r\n"})),e.next=11,O({key:t,action:n,resource:o},{onError:function(e){x(!1),p(!1),d.b.error(e.message)},onSuccess:function(e,n){x(!1),p(!1),d.b.success("Changes saved!"),g.a.refetchQueries(t),r()}});case 11:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),[O,r]),P=s.a.useCallback((function(e,t,n){B.current=e,t.languages.register({id:"psulog"}),t.languages.setMonarchTokensProvider("psulog",{tokenizer:{root:[[/\[error.*/,"custom-error"],[/\[verbose.*/,"custom-verbose"],[/\[warning.*/,"custom-warning"],[/\[debug.*/,"custom-debug"],[/\[information.*/,"custom-info"]]}});var o=e.getModel();i||o.onDidChangeContent((function(){var e=o.getVersionId();!function(e,t){var n;return function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];clearTimeout(n),n=setTimeout((function(){return e.apply(void 0,o)}),t)}}(Object(l.a)(c.a.mark((function n(){var r,a,i,l;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=o.getVersionId(),e===r){n.next=3;break}return n.abrupt("return");case 3:return n.next=5,M.a.post(Object(m.s)("/api/v1/editor/parse"),o.getValue(),{headers:{"content-type":"text/plain"}});case 5:a=n.sent,i=a.data,l=i.map((function(e){return{startColumn:e.token.startColumn,endColumn:e.token.endColumn,startLineNumber:e.token.startLine,endLineNumber:e.token.endLine,severity:S.a.Error,message:e.message}})),t.editor.setModelMarkers(o,"powershell",l);case 9:case"end":return n.stop()}}),n)}))),300)()})),n&&e.addCommand(t.KeyMod.CtrlCmd|t.KeyCode.KEY_S,(function(){var e;return N(null===n||void 0===n||null===(e=n.resourceInfo)||void 0===e?void 0:e.parent,"update",n)})),e.addAction({id:"refresh",label:"Refresh",keybindings:[t.KeyCode.F5],precondition:null,keybindingContext:null,contextMenuGroupId:"navigation",contextMenuOrder:1.5,run:function(e){return r(),null}}),e.addAction({id:"format",label:"Format",keybindings:[t.KeyCode.F8],precondition:null,keybindingContext:null,contextMenuGroupId:"navigation",contextMenuOrder:1.5,run:function(){return e.trigger("anyString","editor.action.formatDocument",null),null}})}),[r,N,i]);s.a.useEffect((function(){F&&(F.editor.defineTheme("psu-dark",I),F.editor.defineTheme("psu-light",L),F.editor.setTheme("dark"===k?"psu-dark":"psu-light"))}),[k,F]);var K=s.a.useCallback((function(){var e;return T(null===B||void 0===B||null===(e=B.current)||void 0===e?void 0:e.getValue())}),[T]),R=function(){var e;return null===B||void 0===B||null===(e=B.current)||void 0===e?void 0:e.trigger("keyboard","editor.action.fontZoomIn",{})},U=function(){var e;return null===B||void 0===B||null===(e=B.current)||void 0===e?void 0:e.trigger("keyboard","editor.action.fontZoomOut",{})},$=s.a.useMemo((function(){return{isReadOnly:f,setIsReadOnly:p,onSave:N,monaco:F,editor:null===B||void 0===B?void 0:B.current,userData:y,handleEditorDidMount:P,currentTheme:k,onCopy:K,zoomIn:R,zoomOut:U,isSaving:h}}),[k,P,f,F,K,N,y,h]);return Object(A.jsx)(E.Provider,{value:$,children:t})}function K(e){var t,n,r,o=e.children,a=e.resource;return Object(A.jsx)(y.a,{requiredRoles:["Administrator","Operator"],requiredAccessControls:F.b.Edit,accessControls:null===a||void 0===a?void 0:a.accessControls,allowedWithOneWayGitSync:!1,children:Object(A.jsx)(v.a,{title:"Save",children:s.a.cloneElement(o,{type:(null===o||void 0===o||null===(t=o.props)||void 0===t?void 0:t.type)||"text",icon:(null===o||void 0===o||null===(n=o.props)||void 0===n?void 0:n.icon)||Object(A.jsx)(j.a,{}),onClick:Object(m.a)(null===o||void 0===o||null===(r=o.props)||void 0===r?void 0:r.onClick)})})})}function R(e){var t=Object.assign({},e),n=s.a.useContext(E),r=n.currentTheme,a=n.handleEditorDidMount;return Object(A.jsx)(C.b,Object(o.a)({theme:"dark"===r?"psu-dark":"psu-light",language:"powershell",loading:Object(A.jsx)(f.a,{tip:"Loading content..."}),height:"calc((100vh - 256px) - 48px)",onMount:function(e,t){return a(e,t,null)}},t))}function U(e){var t=e.title,n=e.options,a=e.showSave,i=void 0===a||a,c=e.actions,l=e.hideToolbar,d=Object(r.a)(e,["title","options","showSave","actions","hideToolbar"]),g=s.a.useContext(E),j=g.handleEditorDidMount,y=g.currentTheme,C=g.onSave,w=g.onCopy,I=g.zoomIn,L=g.zoomOut,D=g.isSaving,F=Object(T.j)(),S=null===F||void 0===F?void 0:F.resource;return Object(A.jsx)(p.a,{bordered:!1,bodyStyle:{padding:0},title:t,extra:!l&&Object(A.jsxs)(u.Fragment,{children:[c,Object(A.jsx)(v.a,{title:"Zoom in",children:Object(A.jsx)(b.a,{type:"text",icon:Object(A.jsx)(h.a,{}),onClick:function(){return I()}})}),Object(A.jsx)(v.a,{title:"Zoom out",children:Object(A.jsx)(b.a,{type:"text",icon:Object(A.jsx)(x.a,{}),onClick:function(){return L()}})}),i&&Object(A.jsx)(K,{resource:S,children:Object(A.jsx)(b.a,{icon:D?Object(A.jsx)(O.a,{}):null,onClick:Object(m.a)((function(){var e;return C(null===S||void 0===S||null===(e=S.resourceInfo)||void 0===e?void 0:e.parent,"update",S)}))})}),Object(A.jsx)(v.a,{title:"Copy",children:Object(A.jsx)(b.a,{type:"text",icon:Object(A.jsx)(k.a,{}),onClick:function(){return w()}})}),Object(A.jsx)(T.b,{children:Object(A.jsx)(b.a,{})})]}),children:Object(A.jsx)(R,Object(o.a)(Object(o.a)({language:"powershell",height:"calc((100vh - 256px) - 48px)",value:(null===S||void 0===S?void 0:S.content)||(null===S||void 0===S?void 0:S.scriptBlock)||(null===S||void 0===S?void 0:S.settings)||(null===d||void 0===d?void 0:d.value),onMount:function(e,t){return j(e,t,S)},theme:"dark"===y?"psu-dark":"psu-light",loading:(null===d||void 0===d?void 0:d.loading)||Object(A.jsx)(f.a,{tip:"Loading content..."})},d),{},{options:Object(o.a)({wordWrap:"on",wrappingIndent:"same",minimap:{enabled:!1},lineHeight:20,lineNumbersMinChars:5,scrollBeyondLastLine:!1,hideCursorInOverviewRuler:!0,overviewRulerLanes:0,overviewRulerBorder:!1},n)}))})}}}]);
//# sourceMappingURL=62.d994f7b3.chunk.js.map