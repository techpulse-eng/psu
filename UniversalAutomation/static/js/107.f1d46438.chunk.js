(this["webpackJsonppowershelluniversal.adminconsole"]=this["webpackJsonppowershelluniversal.adminconsole"]||[]).push([[107],{1444:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return Z}));var a=n(0),c=n.n(a),r=n(415),l=n(954),o=n(127),i=n(453),s=n(48),u=n(70),d=n(209),b=n(3);function m(){var e=Object(o.e)(),t=e.onOk,n=e.form;return Object(b.jsxs)(a.Fragment,{children:[Object(b.jsx)(o.d,{requiredRoles:["Administrator"],requiredAccessControls:s.b.Create,allowedWithOneWayGitSync:!0,children:Object(b.jsx)(u.a,{children:"Export Configuration as Template"})}),Object(b.jsx)(o.b,{title:"Export Configuration as Template",onClickOk:function(){t("/template/export","create",{})},children:Object(b.jsx)(d.b,{schemaName:"template",children:Object(b.jsx)(d.d,{name:"create_template_form",form:n,preserve:!1})})})]})}var p=n(12),j=n(49),f=n.n(j),v=n(84),O=n(27),x=n(450),h=n(693),y=n(414),C=n(1590),g=n(926),w=n(7),E=n(10),S=n(16),N=n(9),k=n.n(N),T=n(65),P=n(122),I=n(33),F=n(78),A=n(6);function L(e){return void 0!==e&&null!==e}var q=function(e){var t,n=e.itemPrefixCls,c=e.component,r=e.span,l=e.className,o=e.style,i=e.labelStyle,s=e.contentStyle,u=e.bordered,d=e.label,b=e.content,m=e.colon,p=c;return u?a.createElement(p,{className:k()((t={},Object(w.a)(t,"".concat(n,"-item-label"),L(d)),Object(w.a)(t,"".concat(n,"-item-content"),L(b)),t),l),style:o,colSpan:r},L(d)&&a.createElement("span",{style:i},d),L(b)&&a.createElement("span",{style:s},b)):a.createElement(p,{className:k()("".concat(n,"-item"),l),style:o,colSpan:r},a.createElement("div",{className:"".concat(n,"-item-container")},d&&a.createElement("span",{className:k()("".concat(n,"-item-label"),Object(w.a)({},"".concat(n,"-item-no-colon"),!m)),style:i},d),b&&a.createElement("span",{className:k()("".concat(n,"-item-content")),style:s},b)))};function D(e,t,n){var c=t.colon,r=t.prefixCls,l=t.bordered,o=n.component,i=n.type,s=n.showLabel,u=n.showContent,d=n.labelStyle,b=n.contentStyle;return e.map((function(e,t){var n=e.props,m=n.label,p=n.children,j=n.prefixCls,f=void 0===j?r:j,v=n.className,O=n.style,x=n.labelStyle,h=n.contentStyle,y=n.span,C=void 0===y?1:y,g=e.key;return"string"===typeof o?a.createElement(q,{key:"".concat(i,"-").concat(g||t),className:v,style:O,labelStyle:Object(A.a)(Object(A.a)({},d),x),contentStyle:Object(A.a)(Object(A.a)({},b),h),span:C,colon:c,component:o,itemPrefixCls:f,bordered:l,label:s?m:null,content:u?p:null}):[a.createElement(q,{key:"label-".concat(g||t),className:v,style:Object(A.a)(Object(A.a)(Object(A.a)({},d),O),x),span:1,colon:c,component:o[0],itemPrefixCls:f,bordered:l,label:m}),a.createElement(q,{key:"content-".concat(g||t),className:v,style:Object(A.a)(Object(A.a)(Object(A.a)({},b),O),h),span:2*C-1,component:o[1],itemPrefixCls:f,bordered:l,content:p})]}))}var V=function(e){var t=a.useContext(J),n=e.prefixCls,c=e.vertical,r=e.row,l=e.index,o=e.bordered;return c?a.createElement(a.Fragment,null,a.createElement("tr",{key:"label-".concat(l),className:"".concat(n,"-row")},D(r,e,Object(A.a)({component:"th",type:"label",showLabel:!0},t))),a.createElement("tr",{key:"content-".concat(l),className:"".concat(n,"-row")},D(r,e,Object(A.a)({component:"td",type:"content",showContent:!0},t)))):a.createElement("tr",{key:l,className:"".concat(n,"-row")},D(r,e,Object(A.a)({component:o?["th","td"]:"td",type:"item",showLabel:!0,showContent:!0},t)))},W=function(e){return e.children},z=n(38),J=a.createContext({}),_={xxl:3,xl:3,lg:3,md:3,sm:2,xs:1};function G(e,t,n){var a=e;return(void 0===t||t>n)&&(a=Object(z.a)(e,{span:n}),Object(I.a)(void 0===t,"Descriptions","Sum of column `span` in a line not match `column` of Descriptions.")),a}function R(e){var t,n=e.prefixCls,c=e.title,r=e.extra,l=e.column,o=void 0===l?_:l,i=e.colon,s=void 0===i||i,u=e.bordered,d=e.layout,b=e.children,m=e.className,p=e.style,j=e.size,f=e.labelStyle,v=e.contentStyle,O=a.useContext(F.b),x=O.getPrefixCls,h=O.direction,y=x("descriptions",n),C=a.useState({}),g=Object(E.a)(C,2),N=g[0],I=g[1],A=function(e,t){if("number"===typeof e)return e;if("object"===Object(S.a)(e))for(var n=0;n<P.b.length;n++){var a=P.b[n];if(t[a]&&void 0!==e[a])return e[a]||_[a]}return 3}(o,N);a.useEffect((function(){var e=P.a.subscribe((function(e){"object"===Object(S.a)(o)&&I(e)}));return function(){P.a.unsubscribe(e)}}),[]);var L=function(e,t){var n=Object(T.a)(e).filter((function(e){return e})),a=[],c=[],r=t;return n.forEach((function(e,l){var o,i=null===(o=e.props)||void 0===o?void 0:o.span,s=i||1;if(l===n.length-1)return c.push(G(e,i,r)),void a.push(c);s<r?(r-=s,c.push(e)):(c.push(G(e,s,r)),a.push(c),r=t,c=[])})),a}(b,A);return a.createElement(J.Provider,{value:{labelStyle:f,contentStyle:v}},a.createElement("div",{className:k()(y,(t={},Object(w.a)(t,"".concat(y,"-").concat(j),j&&"default"!==j),Object(w.a)(t,"".concat(y,"-bordered"),!!u),Object(w.a)(t,"".concat(y,"-rtl"),"rtl"===h),t),m),style:p},(c||r)&&a.createElement("div",{className:"".concat(y,"-header")},c&&a.createElement("div",{className:"".concat(y,"-title")},c),r&&a.createElement("div",{className:"".concat(y,"-extra")},r)),a.createElement("div",{className:"".concat(y,"-view")},a.createElement("table",null,a.createElement("tbody",null,L.map((function(e,t){return a.createElement(V,{key:t,index:t,colon:s,prefixCls:y,vertical:"vertical"===d,bordered:u,row:e})})))))))}R.Item=W;var U=R,$=n(946),B=n(452),H=n(651),K=n(117),M=n.n(K);function Q(e){var t=e.download,n=c.a.useState(null),a=Object(O.a)(n,2),r=a[0],l=a[1],o=c.a.useState(!1),i=Object(O.a)(o,2),s=i[0],d=i[1],m=c.a.useState(!1),j=Object(O.a)(m,2),w=j[0],E=j[1],S=c.a.useState(!1),N=Object(O.a)(S,2),k=N[0],T=N[1],P=c.a.useState([]),I=Object(O.a)(P,2),F=I[0],A=I[1],L=function(){var t=Object(v.a)(f.a.mark((function t(){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return T(!0),t.next=3,M.a.post("/api/v1/template/read/".concat(e.name,"/").concat(e.version));case 3:if(200===(n=t.sent).status){t.next=8;break}return x.b.error(n.statusText),T(!1),t.abrupt("return");case 8:l(n.data),T(!1),d(!0);case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),q=function(e,t){F.find((function(t){return t.name===e})).value=t,A(F)},D={name:"file",action:"/api/v1/template/read",onChange:function(e){"done"===e.file.status?(d(!0),l(e.file.response),A(e.file.response.variables)):"error"===e.file.status&&x.b.error("".concat(e.file.name," file upload failed."))}},V=function(){E(!1),l(null),d(!1)},W=function(){E(!0),M.a.post("/api/v1/template/import",F).then((function(e){x.b.success("Template applied successfully!"),E(!1),l(null),d(!1)})).catch((function(){x.b.error("Template failed to apply!"),E(!1),l(null),d(!1)}))};return Object(b.jsxs)(c.a.Fragment,{children:[!t&&Object(b.jsx)(C.a,Object(p.a)(Object(p.a)({},D),{},{children:Object(b.jsx)(u.a,{icon:Object(b.jsx)(H.a,{}),children:"Import Template"})})),t&&Object(b.jsx)(u.a,{icon:Object(b.jsx)(H.a,{}),loading:k,onClick:L,children:"Import Template"}),Object(b.jsxs)(g.a,{visible:s,onOk:W,onCancel:V,footer:[Object(b.jsx)(u.a,{type:"default",onClick:V,children:"Cancel"}),Object(b.jsx)(u.a,{type:"primary",loading:w,onClick:W,children:"Apply"},"submit")],children:[Object(b.jsxs)(U,{title:null===r||void 0===r?void 0:r.name,children:[Object(b.jsx)(U.Item,{label:"Version",children:null===r||void 0===r?void 0:r.version}),Object(b.jsx)(U.Item,{label:"Author",children:null===r||void 0===r?void 0:r.author})]}),Object(b.jsx)(y.a.Text,{type:"secondary",children:null===r||void 0===r?void 0:r.description}),(null===r||void 0===r?void 0:r.variables.length)>0&&Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)($.a,{}),Object(b.jsx)(y.a.Title,{level:4,children:"Variables"}),Object(b.jsx)(y.a.Text,{type:"secondary",children:"Customize variables for this template."}),Object(b.jsx)("p",{}),Object(b.jsx)(B.b,{direction:"vertical",children:null===r||void 0===r?void 0:r.variables.map((function(e){var t=null;return e.vault&&""!==e.vault?"String"===e.type?t=Object(b.jsx)(h.default.Password,{placeholder:e.name,onChange:function(t){return q(e.name,t.target.value)}}):"PSCredential"===e.type&&(t=Object(b.jsxs)(c.a.Fragment,{children:[Object(b.jsx)(h.default,{placeholder:"User Name",onChange:function(t){return n=e.name,a=t.target.value,F.find((function(e){return e.name===n})).userName=a,void A(F);var n,a}}),Object(b.jsx)(h.default.Password,{placeholder:"Password",onChange:function(t){return n=e.name,a=t.target.value,F.find((function(e){return e.name===n})).password=a,void A(F);var n,a}})]})):t=Object(b.jsx)(h.default,{placeholder:e.name,onChange:function(t){return q(e.name,t.target.value)}}),Object(b.jsxs)(c.a.Fragment,{children:[Object(b.jsxs)(y.a,{children:["$",e.name]}),Object(b.jsx)(y.a.Text,{type:"secondary",children:e.description}),t]})}))})]})]})]})}var X=n(456),Y=[{title:"Name",dataIndex:"name",key:"name",editable:!1},{title:"Description",dataIndex:"description",key:"description",editable:!1},{title:"Version",dataIndex:"version",key:"version",editable:!1},{width:"fit-content",dataIndex:"actions",editable:!1,render:function(e,t){return Object(b.jsx)(Q,{name:t.name,version:t.version,download:!0})}}];function Z(){var e=Object(r.a)("/template",{enabled:!1,refetchOnWindowFocus:!1}),t=e.data,n=e.isLoading,a=e.refetch;return Object(b.jsx)(l.a,{title:"Templates",subTitle:"Community contributed templates that contain pre-built configurations.",extra:[Object(b.jsx)(X.a,{url:"platform/templates"})],children:Object(b.jsx)(i.default,{title:"Templates",actions:[Object(b.jsx)(o.a,{children:Object(b.jsx)(m,{})}),Object(b.jsx)(Q,{})],columns:Y,data:t,loading:n,queryFn:a})})}}}]);
//# sourceMappingURL=107.f1d46438.chunk.js.map